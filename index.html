<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Career Oracle - AIèŒåœºå†³ç­–é¡¾é—®</title>
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <style>
        * { box-sizing: border-box; margin: 0; padding: 0; }
        body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", "PingFang SC", "Microsoft YaHei", sans-serif; line-height: 1.6; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); min-height: 100vh; padding: 20px; }
        .container { max-width: 800px; margin: 0 auto; background: #fff; padding: 40px; border-radius: 16px; box-shadow: 0 20px 60px rgba(0,0,0,0.3); }
        h1 { text-align: center; color: #667eea; font-size: 2.5em; margin-bottom: 10px; }
        .subtitle { text-align: center; color: #6c757d; margin-bottom: 30px; }
        h2 { color: #343a40; border-left: 4px solid #667eea; padding-left: 15px; margin: 30px 0 20px; }
        textarea { width: 100%; padding: 18px; border-radius: 10px; border: 2px solid #e9ecef; font-size: 16px; resize: vertical; font-family: inherit; }
        textarea:focus { outline: none; border-color: #667eea; box-shadow: 0 0 0 4px rgba(102,126,234,0.1); }
        .btn { display: block; width: 100%; padding: 18px; font-size: 18px; font-weight: bold; color: #fff; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border: none; border-radius: 10px; cursor: pointer; margin-top: 15px; }
        .btn:hover { transform: translateY(-3px); box-shadow: 0 10px 30px rgba(102,126,234,0.4); }
        .btn:disabled { background: #adb5bd; transform: none; cursor: not-allowed; }
        #trial-info { text-align: center; padding: 12px; border-radius: 8px; margin: 20px 0; font-weight: 600; background: #d4edda; color: #155724; }
        #loading { text-align: center; padding: 40px; display: none; }
        .spinner { width: 50px; height: 50px; border: 4px solid #f3f3f3; border-top: 4px solid #667eea; border-radius: 50%; animation: spin 1s linear infinite; margin: 0 auto 20px; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
        .report-section { margin-top: 30px; padding: 30px; background: #f8f9fa; border-radius: 12px; border-left: 5px solid #667eea; }
        .report-section h2, .report-section h3 { color: #495057; border: none; padding: 0; }
        .error-msg { color: #721c24; background: #f8d7da; padding: 20px; border-radius: 10px; text-align: center; margin-top: 20px; }
        .pricing-table { display: flex; justify-content: center; gap: 20px; flex-wrap: wrap; margin-top: 25px; }
        .pricing-card { background: #fff; border: 2px solid #e9ecef; border-radius: 12px; padding: 25px; width: 220px; text-align: center; }
        .pricing-card:hover { transform: translateY(-5px); border-color: #667eea; }
        .pricing-card.featured { border-color: #667eea; transform: scale(1.05); }
        .pricing-card h3 { color: #667eea; margin-bottom: 15px; }
        .price { font-size: 36px; font-weight: bold; }
        .pricing-card ul { list-style: none; text-align: left; margin: 20px 0; font-size: 14px; }
        .pricing-card li { padding: 8px 0 8px 25px; position: relative; }
        .pricing-card li::before { content: "âœ“"; position: absolute; left: 0; color: #28a745; }
        .pricing-card .btn { font-size: 14px; padding: 12px; }
        .modal-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.7); display: none; align-items: center; justify-content: center; z-index: 1000; }
        .modal-content { background: #fff; padding: 35px; border-radius: 16px; width: 360px; text-align: center; position: relative; }
        .modal-close { position: absolute; top: 15px; right: 20px; font-size: 28px; cursor: pointer; color: #aaa; }
        #payment-amount { font-size: 42px; color: #dc3545; font-weight: bold; margin: 15px 0; }
        #qr-code-image { width: 200px; height: 200px; margin: 20px auto; display: block; border-radius: 10px; border: 2px solid #eee; }
        footer { text-align: center; margin-top: 40px; color: #6c757d; font-size: 14px; }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ”® Career Oracle</h1>
        <p class="subtitle">AIé©±åŠ¨çš„èŒåœºå†³ç­–é¡¾é—®</p>
        <h2>ğŸ“ æè¿°æ‚¨çš„æƒ…å†µ</h2>
        <textarea id="userInput" rows="8" placeholder="ä¾‹å¦‚ï¼šæˆ‘ä»Šå¹´28å²ï¼Œåœ¨äº’è”ç½‘å…¬å¸åšäº†3å¹´è¿è¥ï¼Œæ„Ÿè§‰é‡åˆ°ç“¶é¢ˆ..."></textarea>
        <div id="trial-info"></div>
        <button id="generate-button" class="btn" onclick="handleGeneration()">ğŸš€ ç”Ÿæˆæˆ‘çš„èŒåœºå†³ç­–æŠ¥å‘Š</button>
        <div id="loading"><div class="spinner"></div><p style="color:#667eea;">AIæ­£åœ¨åˆ†æä¸­ï¼Œè¯·ç¨å€™ï¼ˆçº¦15-30ç§’ï¼‰...</p></div>
        <div id="report-output"></div>
        <div style="margin-top:50px;padding-top:30px;border-top:2px solid #e9ecef;">
            <h2>ğŸ’ äº§å“ä¸æœåŠ¡</h2>
            <div class="pricing-table">
                <div class="pricing-card"><h3>å•æ¬¡å’¨è¯¢</h3><p class="price">Â¥1</p><ul><li>AIé©±åŠ¨åˆ†æ</li><li>å®Œæ•´èŒä¸šæŠ¥å‘Š</li></ul><button class="btn" onclick="showPaymentModal('å•æ¬¡å’¨è¯¢','1')">è´­ä¹°</button></div>
                <div class="pricing-card featured"><h3>å¹´åº¦ä¼šå‘˜</h3><p class="price">Â¥18</p><ul><li>æ— é™æ¬¡æŠ¥å‘Š</li><li>æŒç»­æ›´æ–°</li></ul><button class="btn" onclick="showPaymentModal('å¹´åº¦ä¼šå‘˜','18')">è®¢é˜…</button></div>
                <div class="pricing-card"><h3>å¯¼å‡ºæŠ¥å‘Š</h3><p class="price">Â¥1</p><ul><li>å¯¼å‡ºæ–‡ä»¶</li><li>æ°¸ä¹…ä¿å­˜</li></ul><button class="btn" onclick="exportReport()">å¯¼å‡º</button></div>
            </div>
        </div>
        <footer><p>Â© 2024 Career Oracle Â· Powered by Kimi AI</p></footer>
    </div>
    <div id="payment-modal" class="modal-overlay" onclick="closeModal()">
        <div class="modal-content" onclick="event.stopPropagation()">
            <span class="modal-close" onclick="closeModal()">&times;</span>
            <h3 id="payment-title">æ”¯ä»˜</h3>
            <p id="payment-amount"></p>
            <img id="qr-code-image" src="" alt="äºŒç»´ç ">
            <button class="btn" onclick="confirmPayment()" style="margin-top:20px">âœ… æˆ‘å·²å®Œæˆæ”¯ä»˜</button>
        </div>
    </div>
    <script>
        const API_ENDPOINT = '/api/chat';
        const QR_CODE_URL = 'https://s41.ax1x.com/2026/02/08/pZThSNd.jpg';
        const FREE_TRIALS = 3;
        let count = parseInt(localStorage.getItem('careerCount') || '0');
        let currentReport = '';
        let payCallback = null;

        window.onload = updateInfo;

        function updateInfo() {
            const info = document.getElementById('trial-info');
            const btn = document.getElementById('generate-button');
            const left = FREE_TRIALS - count;
            if (left > 0) {
                info.innerHTML = 'ğŸ æ‚¨è¿˜æœ‰ <strong>' + left + '</strong> æ¬¡å…è´¹æœºä¼š';
                btn.textContent = 'ğŸš€ å…è´¹ç”Ÿæˆæˆ‘çš„èŒåœºå†³ç­–æŠ¥å‘Š';
            } else {
                info.style.background = '#fff3cd'; info.style.color = '#856404';
                info.innerHTML = 'âš¡ å…è´¹æ¬¡æ•°å·²ç”¨å®Œ';
                btn.textContent = 'ğŸš€ ç”ŸæˆæŠ¥å‘Š (Â¥1)';
            }
        }

        function handleGeneration() {
            if (!document.getElementById('userInput').value.trim()) { alert('è¯·è¾“å…¥æ‚¨çš„æƒ…å†µ'); return; }
            if (count < FREE_TRIALS) callAI(); else showPaymentModal('ç”ŸæˆæŠ¥å‘Š', '1', callAI);
        }

        async function callAI() {
            const input = document.getElementById('userInput').value.trim();
            const loading = document.getElementById('loading');
            const output = document.getElementById('report-output');
            const btn = document.getElementById('generate-button');
            closeModal(); loading.style.display = 'block'; output.innerHTML = ''; btn.disabled = true;
            try {
                const res = await fetch(API_ENDPOINT, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ userInput: input })
                });
                const data = await res.json();
                if (!res.ok || data.error) throw new Error(data.error || 'è¯·æ±‚å¤±è´¥');
                if (!data.report) throw new Error('AIæœªè¿”å›æŠ¥å‘Š');
                currentReport = data.report;
                output.innerHTML = '<div class="report-section">' + marked.parse(data.report) + '</div>';
                if (count < FREE_TRIALS) { count++; localStorage.setItem('careerCount', count); updateInfo(); }
                output.scrollIntoView({ behavior: 'smooth' });
            } catch (e) {
                output.innerHTML = '<div class="error-msg">âŒ ' + e.message + '</div>';
            } finally { loading.style.display = 'none'; btn.disabled = false; }
        }

        function exportReport() {
            if (!currentReport) { alert('è¯·å…ˆç”ŸæˆæŠ¥å‘Š'); return; }
            showPaymentModal('å¯¼å‡ºæŠ¥å‘Š', '1', () => {
                const blob = new Blob([currentReport], { type: 'text/markdown' });
                const a = document.createElement('a'); a.href = URL.createObjectURL(blob);
                a.download = 'Career_Oracle_æŠ¥å‘Š.md'; a.click(); closeModal(); alert('âœ… å¯¼å‡ºæˆåŠŸï¼');
            });
        }

        function showPaymentModal(title, price, cb) {
            document.getElementById('payment-title').textContent = 'æ”¯ä»˜ï¼š' + title;
            document.getElementById('payment-amount').textContent = 'Â¥' + price;
            document.getElementById('qr-code-image').src = QR_CODE_URL;
            document.getElementById('payment-modal').style.display = 'flex';
            payCallback = cb;
        }

        function confirmPayment() { if (payCallback) { payCallback(); payCallback = null; } }
        function closeModal() { document.getElementById('payment-modal').style.display = 'none'; payCallback = null; }
    </script>
</body>
</html>
       
